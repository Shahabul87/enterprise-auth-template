# Core FastAPI and ASGI - Updated for security patches
fastapi==0.110.0  # Updated from 0.104.1 (security fixes for OAuth and validation)
uvicorn[standard]==0.27.1  # Updated from 0.24.0 (WebSocket security improvements)
gunicorn==21.2.0

# Database - Updated for performance and security
sqlalchemy[asyncio]==2.0.25  # Updated from 2.0.23 (async performance improvements)
asyncpg==0.29.0
alembic==1.13.1  # Updated from 1.12.1 (migration security fixes)

# Authentication & Security - CRITICAL UPDATES
python-jose[cryptography]==3.3.0
passlib[bcrypt]==1.7.4
python-multipart==0.0.7  # Updated from 0.0.6 (DoS vulnerability fix)

# Validation & Serialization - Updated for security
pydantic==2.6.1  # Updated from 2.5.0 (validation bypass fixes)
pydantic-settings==2.1.0
email-validator==2.1.0.post1  # Updated for regex DoS fix

# Caching & Session Management - Updated for Redis security
redis==5.0.1
aioredis==2.0.1

# Background Tasks - Security updates
celery==5.3.6  # Updated from 5.3.4 (pickle deserialization security fix)
flower==2.0.1

# HTTP Client for OAuth - Security patches
httpx==0.26.0  # Updated from 0.25.2 (connection pooling security fix)
authlib==1.3.0  # Updated from 1.2.1 (OAuth token validation improvements)

# WebAuthn (Passkeys) - Updated for latest security standards
webauthn==1.11.1

# Logging & Monitoring - Updated versions
structlog==23.2.0
prometheus-client==0.20.0  # Updated from 0.19.0 (metrics security improvements)
python-json-logger==2.0.7  # Added for structured JSON logging

# Utilities - Security updates
python-dateutil==2.8.2
pytz==2024.1  # Updated from 2023.3 (timezone data security updates)
click==8.1.7

# Template rendering - CRITICAL SECURITY UPDATE
jinja2==3.1.3  # Updated from 3.1.2 (template injection vulnerability fix)

# Email Services - Security updates
aiosmtplib==3.0.1
sendgrid==6.11.0
aioboto3==12.1.0

# Two-Factor Authentication - CRITICAL SECURITY UPDATES
pyotp==2.9.0
qrcode[pil]==7.4.2
cryptography==42.0.5  # Updated from 41.0.7 (CRITICAL: multiple CVEs fixed including RSA timing attacks)

# Additional Security Dependencies
# Added for enhanced security monitoring and protection
bcrypt==4.1.2  # Explicit version for password hashing (security update)
cffi==1.16.0  # Explicit version to avoid build issues with cryptography